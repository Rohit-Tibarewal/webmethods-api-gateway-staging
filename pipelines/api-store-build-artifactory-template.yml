parameters:
- name: target_stage

steps:
- task: JFrog.jfrog-artifactory-vsts-extension.artifactory-generic-upload.ArtifactoryGenericUpload@2
  displayName: 'Artifactory Build Upload'
  inputs:
    artifactoryService: '$(artifactoryService)'
    fileSpec: |
      {
        "files": [
          {
            "pattern": "$(System.DefaultWorkingDirectory)/$(Build.BuildId)_${{parameters.target_stage}}_${{parameters.api_project}}_export.zip",
            "target": "$(artifactoryFolder)/"
          }
        ]
      }
  condition: eq(variables['useArtifactory'], 'true')